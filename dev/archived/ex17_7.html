<!DOCTYPE html>
<html>
	<head>
		<title>AJAX Example</title>
		
	</head>
		
	<body style='text-align:center'>
		<h1>Loading a web page into a DIV</h1>
		<div id='info'>This sentence will be replaced</div>
		
		<script>
			var nocache = "&nocache=" + Math.random() * 1000000;
			var url = "rss.news.yahoo.com/rss/topstories";
			var out = "";
			var request = new ajaxRequest();
			if (request.overrideMimeType){
				request.overrideMimeType('text/xml');
			}
			request.open("GET", "ex17_6.php?url=" + url + nocache, true);
			
			request.onreadystatechange = function(){ // this is set up as an anonymous funcion but it could also be a named function. Still use *this* keyword
				
				if(this.readyState == 4){
					if(this.status == 200){
						if(this.responseText != null){
							titles = this.responseXML.getElementsByTagName('title');
							var j;
							for(var j=0; j < titles.length; j++){
								out += titles[j].childNodes[0].nodeValue + '<br>';	
							}
							putContentInto($('info'), out);	
						}else{
							alert("AJAX error: No data received");
						}
					}else{
						alert("AJAX error: " + this.statustText);
					}
				}
			}
			
			request.send(null); // make the URL request
			
			
			function ajaxRequest(){
				var request;
				
				try{ // non IE Browser test
					request = new XMLHttpRequest();
				}
				catch(e1){
					try{ // IE 6+ test
						request = new ActiveXObject("Msxml2.XMLHTTP");
					}
					catch(e2){
						try{ // IE5 test
							request = new ActiveXObject("Microsoft.XMLHTTP");
						}
						catch(e3){ // no AJAX support
							request = false;
						}
					}
				}
				
				return(request);
			}
			
			function $(id){
				return document.getElementById(id);
			}
			
			function putContentInto(element,text){
				element.innerHTML = text;
			}
			
		</script>
	</body>
	
</html>