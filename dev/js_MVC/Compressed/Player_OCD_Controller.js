var Player_OCD_Controller=Player_Controller.extend({construct:function(){this.SC.construct();this._className="Player_OCD";this._hitTestHeadView;this._hitTestTorsoView;this._headRect;this._torsoRect;this._turnLeftFrame;this._turnRightFrame;this._interactFrame;this._stickyLiftOffset;this._visibleFrameNumber;},bindView:function(view,data){this.init(data);this._view=view;this._view.init(this,data);},init:function(data){;this._rect={top:0,right:0,bottom:0,left:0};this.setIsHoldingObject(false);this._stopFrame=data.stopFrame;this._turnLeftFrame=data.turnLeftFrame;this._turnRightFrame=data.turnRightFrame;this._interactFrame=data.interactFrame;this._stickyLiftOffset=data.stickyLiftOffset;this._visibleFrameNumber=0;this.setWalkFrames(data.walkFrames);this.addListners();},addListners:function(){g_eventHandler.addAListener("setNonGraphicRect",this);},bindHitTestHeadView:function(view,data){this._hitTestHeadView=view;this._hitTestHeadView.init(this,data);},bindHitTestTorsoView:function(view,data){this._hitTestTorsoView=view;this._hitTestTorsoView.init(this,data);},setNonGraphicRect:function(data){if(data.id=="playerHead"){this._headRect=data.rect;}else if(data.id=="playerTorso"){this._torsoRect=data.rect;}},startTurnLeft:function(){this._view.getImageController().hideFrameNum(this._stopFrame);this._view.getImageController().showFrameNum(this._turnLeftFrame);this._visibleFrameNumber=this._turnLeftFrame;},startTurnRight:function(){this._view.getImageController().hideFrameNum(this._stopFrame);this._view.getImageController().showFrameNum(this._turnRightFrame);this._visibleFrameNumber=this._turnRightFrame;},startInteract:function(){this._view.getImageController().hideFrameNum(this._stopFrame);this._view.getImageController().showFrameNum(this._interactFrame);this._visibleFrameNumber=this._interactFrame;},walk:function(){this._view.getImageController().hideFrameNum(this._walkFrames[0]);this._walkFrames.push(this._walkFrames.shift());this._view.getImageController().showFrameNum(this._walkFrames[0]);this._visibleFrameNumber=this._walkFrames[0];},stopWalk:function(){this._walkFrames.unshift(this._walkFrames.pop());for(var i=0;i<this._walkFrames.length;i++){this._view.getImageController().hideFrameNum(this._walkFrames[i]);}
this._view.getImageController().hideFrameNum(this._turnLeftFrame);this._view.getImageController().hideFrameNum(this._turnRightFrame);this._view.getImageController().hideFrameNum(this._interactFrame);this._view.getImageController().showFrameNum(this._stopFrame);this._visibleFrameNumber=this._stopFrame;},getStickyOffset:function(){return this._stickyLiftOffset[this._visibleFrameNumber]},getTransformedHeadRect:function(data,stageRotation){switch(stageRotation){case 0:var topRounded=Math.floor(data.y+this._headRect.top);var rightRounded=Math.floor(data.x+this._headRect.right);var bottomRounded=Math.floor(data.y+this._headRect.bottom);var leftRounded=Math.floor(data.x+this._headRect.left);break;case 90:var topRounded=Math.floor((data.y+data.h)-this._headRect.right);var rightRounded=Math.floor(data.x+this._headRect.bottom);var bottomRounded=Math.floor((data.y+data.h)-this._headRect.left);var leftRounded=Math.floor(data.x+this._headRect.top);break;case 180:var topRounded=Math.floor((data.y+data.h)-this._headRect.bottom);var rightRounded=Math.floor((data.x+data.w)-this._headRect.left);var bottomRounded=Math.floor((data.y+data.h)-this._headRect.top);var leftRounded=Math.floor((data.x+data.w)-this._headRect.right);break;case 270:var topRounded=Math.floor(data.y+this._headRect.left);var rightRounded=Math.floor((data.x+data.w)-this._headRect.top);var bottomRounded=Math.floor(data.y+this._headRect.right);var leftRounded=Math.floor((data.x+data.w)-this._headRect.bottom);break;}
return{top:topRounded,right:rightRounded,bottom:bottomRounded,left:leftRounded};},getTransformedTorsoRect:function(data,stageRotation){var tempRect;switch(stageRotation){case 0:var topRounded=Math.floor(data.y+this._torsoRect.top);var rightRounded=Math.floor(data.x+this._torsoRect.right);var bottomRounded=Math.floor((data.y+data.h));var leftRounded=Math.floor(data.x+this._torsoRect.left);break;case 90:var topRounded=Math.floor((data.y+data.h)-this._torsoRect.right);var rightRounded=Math.floor(data.x+data.w);var bottomRounded=Math.floor((data.y+data.h)-this._torsoRect.left);var leftRounded=Math.floor((data.x)+this._torsoRect.top);break;case 180:var topRounded=Math.floor(data.y);var rightRounded=Math.floor((data.x+data.w)-this._torsoRect.left);var bottomRounded=Math.floor((data.y+data.h)-this._torsoRect.top);var leftRounded=Math.floor((data.x+data.w)-this._torsoRect.right);break;case 270:var topRounded=Math.floor(data.y+this._torsoRect.left);var rightRounded=Math.floor((data.x+data.w)-this._torsoRect.top);var bottomRounded=Math.floor(data.y+this._torsoRect.right);var leftRounded=Math.floor(data.x);;break;}
return{top:topRounded,right:rightRounded,bottom:bottomRounded,left:leftRounded};}});