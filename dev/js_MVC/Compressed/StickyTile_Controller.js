var StickyTile_Controller=OnOffTileControl_Controller.extend({construct:function(){this.SC.construct();this._attached=false;this._holdingOffset;this._className="StickyTile";},addListners:function(){g_eventHandler.addAListener("resetPosition",this);},onPressForInteraction:function(){g_eventHandler.dispatchAnEvent("pickUpItem",{controller:this});},setAttached:function(bool){this._attached=bool;},setHoldingOffset:function(offsetObj){this._holdingOffset=offsetObj;},setDroppedRect:function(rect,rotation,player){var top=0;var right=0;var bottom=0;var left=0;switch(rotation){case 0:top=rect.top+(45+player.getStickyOffset());left=rect.right-(this.getViewWidth()/2);bottom=top+this.getViewHeight();right=left+this.getViewWidth();break;case 90:top=rect.top-(this.getViewWidth()/2);left=rect.left+(45+player.getStickyOffset());bottom=rect.top+this.getViewWidth();right=left+this.getViewHeight();break;case 180:top=rect.bottom-((45+this.getViewHeight())+player.getStickyOffset());left=rect.left-(this.getViewWidth()/2);bottom=top+this.getViewHeight()
right=left+this.getViewWidth();break;case 270:top=rect.bottom-(this.getViewWidth()/2);left=rect.right-((45+this.getViewHeight())+player.getStickyOffset());bottom=top+this.getViewWidth()
right=left+this.getViewHeight();break;}
this._rect.top=Math.floor(top);this._rect.right=Math.floor(right);this._rect.bottom=Math.floor(bottom);this._rect.left=Math.floor(left);},attachUnattach:function(){this._attached=!this._attached;this._frames.unshift(this._frames.pop());this._view.getImageController().showFrameNum(this._frames[0]);this._view.getImageController().hideFrameNum(this._frames[1]);if(this._attached){this.removeQuads();g_eventHandler.dispatchAnEvent("stickyObjectLifted",{controller:this});}else{g_eventHandler.dispatchAnEvent("stickyObjectDropped",{controller:this});}},actedUpon:function(){this.interact();if(this.listener.getViewID()!="sprite_tile0"){this.listener.interact();}},stickToPlayer:function(rect,rotation,player){var stringRotation=String(rotation);switch(rotation){case 0:this.setViewCSS({"top":(rect.top+(45+player.getStickyOffset())+this._holdingOffset[stringRotation][1])+"px","left":(rect.right-(this.getViewWidth()/2)+this._holdingOffset[stringRotation][0])+"px"});this.setViewCSS({WebkitTransform:'rotate('+0+'deg)'});this.setViewCSS({'-moz-transform':'rotate('+0+'deg)'});break;case 90:this.setViewCSS({"top":(rect.top-(this.getViewWidth()/2)+this._holdingOffset[stringRotation][0])+"px","left":(rect.left+(45+player.getStickyOffset())+this._holdingOffset[stringRotation][1])+"px"});this.setViewCSS({WebkitTransform:'rotate('+270+'deg)'});this.setViewCSS({'-moz-transform':'rotate('+270+'deg)'});break;case 180:this.setViewCSS({"top":(rect.bottom-((45+this.getViewHeight())+player.getStickyOffset())+this._holdingOffset[stringRotation][1])+"px","left":(rect.left-(this.getViewWidth()/2)+this._holdingOffset[stringRotation][0])+"px"});this.setViewCSS({WebkitTransform:'rotate('+180+'deg)'});this.setViewCSS({'-moz-transform':'rotate('+180+'deg)'});break;case 270:this.setViewCSS({"top":(rect.bottom-(this.getViewWidth()/2)+this._holdingOffset[stringRotation][0])+"px","left":(rect.right-((45+this.getViewHeight())+player.getStickyOffset())+this._holdingOffset[stringRotation][1])+"px"});this.setViewCSS({WebkitTransform:'rotate('+90+'deg)'});this.setViewCSS({'-moz-transform':'rotate('+90+'deg)'});break;}},stickForTurn:function(rect){switch(this._mainController.getStageRotation()){case 0:this.setViewCSS({"top":(rect.top+30)+"px","left":(rect.left+35)+"px"});this.setViewCSS({WebkitTransform:'rotate('+0+'deg)'});this.setViewCSS({'-moz-transform':'rotate('+0+'deg)'});break;case 90:this.setViewCSS({"top":(rect.bottom-35)+"px","left":(rect.left+30)+"px"});this.setViewCSS({WebkitTransform:'rotate('+270+'deg)'});this.setViewCSS({'-moz-transform':'rotate('+270+'deg)'});break;case 180:this.setViewCSS({"top":(rect.bottom-30)+"px","left":(rect.right-35)+"px"});this.setViewCSS({WebkitTransform:'rotate('+180+'deg)'});this.setViewCSS({'-moz-transform':'rotate('+180+'deg)'});break;case 270:this.setViewCSS({"top":(rect.top+35)+"px","left":(rect.right-30)+"px"});this.setViewCSS({WebkitTransform:'rotate('+90+'deg)'});this.setViewCSS({'-moz-transform':'rotate('+90+'deg)'});break;}},resetPosition:function(){this.removeQuads();this.getView().resetPosition();this.createQuads();}});